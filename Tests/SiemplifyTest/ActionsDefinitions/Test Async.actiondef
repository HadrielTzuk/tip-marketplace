{
    "Name": "Test Async", 
    "Description": "", 
    "Script": "from SiemplifyAction import *\r\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_INPROGRESS, EXECUTION_STATE_FAILED, EXECUTION_STATE_TIMEDOUT\r\nimport SiemplifyUtils\r\nfrom SiemplifyUtils import unix_now, output_handler\r\nimport sys\r\n\r\nSCRIPT_NAME = \"WaitFor3rdParty\"\r\n\r\n\r\n@output_handler\r\ndef main(is_first_run, stdout_handler=None):\r\n    siemplify = SiemplifyAction(stdout_handler=stdout_handler)\r\n    siemplify.script_name = SCRIPT_NAME\r\n\r\n    siemplify.LOGGER.info(\"FirstRun = {0}\".format(is_first_run))\r\n\r\n    async_mode = siemplify.parameters[\"IsAsync\"].lower() == str(True).lower()\r\n    finish_in_time = siemplify.parameters[\"FinishInTime\"].lower() == str(True).lower()\r\n    finish_in_grace = siemplify.parameters[\"FinishInGrace\"].lower() == str(True).lower()\r\n    async_never_finish = siemplify.parameters[\"AsyncNeverFinish\"].lower() == str(True).lower()\r\n    fail_normal = siemplify.parameters[\"Fail Normal\"].lower() == str(True).lower()\r\n    fail_async = siemplify.parameters[\"Fail Async\"].lower() == str(True).lower()\r\n    exception_on_fail = siemplify.parameters[\"Exception on Fail\"].lower() == str(True).lower()\r\n    password = siemplify.parameters[\"Password\"]\r\n    comment = siemplify.parameters[\"Comment\"]\r\n\r\n    if (async_never_finish):\r\n        siemplify.end(\"ASYNC never finish\", \"ASYNC never finish\", EXECUTION_STATE_INPROGRESS)\r\n    else:\r\n        finished = False\r\n        result = siemplify.default_result_value\r\n        status = EXECUTION_STATE_COMPLETED\r\n\r\n        if not async_mode and fail_normal:\r\n            result = \"Normal (First run) failure\"\r\n            status = EXECUTION_STATE_FAILED\r\n            finished = True\r\n            if (exception_on_fail):\r\n                raise Exception(\"Explosion!\")\r\n\r\n        if async_mode and fail_async:\r\n            result = \"Async run failure\"\r\n            status = EXECUTION_STATE_FAILED\r\n            finished = True\r\n            if (exception_on_fail):\r\n                raise Exception(\"Explosion!\")\r\n\r\n        while (not finished and SiemplifyUtils.unix_now() < siemplify.execution_deadline_unix_time_ms):\r\n            if (finish_in_time):\r\n                if (async_mode):\r\n                    finished = True\r\n                    if (is_first_run):\r\n                        result = \"Asnyc In Progress\"\r\n                        status = EXECUTION_STATE_INPROGRESS\r\n                    if (not is_first_run):\r\n                        result = \"Asnyc Finished\"\r\n                        status = EXECUTION_STATE_COMPLETED\r\n                else:\r\n                    finished = True\r\n                    result = \"Finished In Time\"\r\n\r\n\r\n        while (not finished and SiemplifyUtils.unix_now() < (siemplify.execution_deadline_unix_time_ms+30000)):\r\n            if (finish_in_grace):\r\n                finished = True\r\n                result += \"Finished In Grace\"\r\n                status = EXECUTION_STATE_TIMEDOUT\r\n\r\n        while (not finished):\r\n            result = \"Im never gonna finish\"\r\n            status = EXECUTION_STATE_TIMEDOUT\r\n\r\n        result += \"{0} Password: {1} Comment: {2}\".format(result, password, comment)\r\n\r\n        siemplify.LOGGER.info(result)\r\n\r\n        if (not finished and async_mode and is_first_run):\r\n            result += \" - First Action\"\r\n            status = EXECUTION_STATE_INPROGRESS\r\n\r\n        siemplify.LOGGER.info(\"{0} - {1}\".format(result, status))\r\n        siemplify.end(result, result, status)\r\n\r\nif __name__ == \"__main__\":\r\n    if len(sys.argv) < 3 or sys.argv[2] == 'True':\r\n        main(True)\r\n    else:\r\n        main(False)", 
    "IntegrationIdentifier": "SiemplifyTest", 
    "ScriptResultName": "ScriptResult", 
    "DynamicResultsMetadata": [
        {
            "ResultName": "JsonResult", 
            "ResultExample": ""
        }
    ], 
    "Creator": "Admin", 
    "IsEnabled": true, 
    "IsCustom": false, 
    "IsSystem": false, 
    "Version": 2.0, 
    "TimeoutSeconds": 600, 
    "Parameters": [
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "true", 
            "Description": null, 
            "Name": "IsAsync", 
            "Value": "true", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507579, 
            "ModificationTimeUnixTimeInMs": 1561374507579
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "true", 
            "Description": null, 
            "Name": "FinishInTime", 
            "Value": "true", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507581, 
            "ModificationTimeUnixTimeInMs": 1561374507581
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "false", 
            "Description": null, 
            "Name": "FinishInGrace", 
            "Value": "false", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507581, 
            "ModificationTimeUnixTimeInMs": 1561374507581
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "false", 
            "Description": null, 
            "Name": "AsyncNeverFinish", 
            "Value": "false", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507581, 
            "ModificationTimeUnixTimeInMs": 1561374507581
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "false", 
            "Description": null, 
            "Name": "Fail Normal", 
            "Value": "false", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507582, 
            "ModificationTimeUnixTimeInMs": 1561374507582
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "false", 
            "Description": null, 
            "Name": "Fail Async", 
            "Value": "false", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507582, 
            "ModificationTimeUnixTimeInMs": 1561374507582
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "false", 
            "Description": null, 
            "Name": "Exception on Fail", 
            "Value": "false", 
            "Type": 1, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507582, 
            "ModificationTimeUnixTimeInMs": 1561374507582
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": true, 
            "DefaultValue": "123456", 
            "Description": null, 
            "Name": "Password", 
            "Value": "123456", 
            "Type": 12, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507582, 
            "ModificationTimeUnixTimeInMs": 1561374507582
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "Some comment", 
            "Description": null, 
            "Name": "Comment", 
            "Value": "Some comment", 
            "Type": 0, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1561374507582, 
            "ModificationTimeUnixTimeInMs": 1561374507582
        }
    ], 
    "DefaultResultValue": "", 
    "Id": -1, 
    "CreationTimeUnixTimeInMs": 1561374507564, 
    "ModificationTimeUnixTimeInMs": 1561374507570
}