{
    "Name": "HTTP Custom Proxy",
    "Description": "Test connection to a given endpoint with given proxy settings (ignore Siemplify proxy).", 
    "Script": "from SiemplifyAction import SiemplifyAction\r\nimport requests\r\nfrom urlparse import urlparse\r\n\r\n\r\nACTION_NAME = 'SiemplifyTest - HTTP Custom Proxy'\r\n\r\n\r\ndef main():\r\n    siemplify = SiemplifyAction()\r\n    siemplify.script_name = ACTION_NAME\r\n\r\n    # Parameters.\r\n    url = siemplify.parameters.get('Endpoint URL')\r\n    method = siemplify.parameters.get('HTTP Method')\r\n\r\n    proxy_server_address = siemplify.parameters.get('Proxy Server Address')\r\n    proxy_username = siemplify.parameters.get('Proxy Username')\r\n    proxy_password = siemplify.parameters.get('Proxy Password')\r\n\r\n    session = requests.Session()\r\n    session.trust_env = False\r\n\r\n    server_url = urlparse(proxy_server_address)\r\n\r\n    scheme = server_url.scheme\r\n    hostname = server_url.hostname\r\n    port = server_url.port\r\n\r\n    credentials = \"\"\r\n\r\n    if proxy_username and proxy_password:\r\n        credentials = \"{0}:{1}@\".format(proxy_username, proxy_password)\r\n\r\n    proxy_str = \"{0}://{1}{2}\".format(scheme, credentials, hostname)\r\n\r\n    if port:\r\n        proxy_str += \":{0}\".format(str(port))\r\n\r\n    proxies = {\r\n        \"http\": proxy_str,\r\n        \"https\": proxy_str\r\n    }\r\n\r\n    response = session.request(method.upper(), url, proxies=proxies)\r\n\r\n    try:\r\n        response.raise_for_status()\r\n    except Exception as e:\r\n        siemplify.LOGGER.error(\"Unable to connect to {}\".format(url))\r\n        siemplify.LOGGER.exception(e)\r\n        raise\r\n\r\n    output_message = \"Successfully connected to {}\".format(url)\r\n    siemplify.end(output_message, 'true')\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\r\n", 
    "IntegrationIdentifier": "SiemplifyTest", 
    "ScriptResultName": "success", 
    "DynamicResultsMetadata": null, 
    "Creator": "admin", 
    "IsEnabled": true, 
    "IsCustom": false, 
    "IsSystem": false, 
    "Version": 0.0, 
    "TimeoutSeconds": 600, 
    "Parameters": [
        {
            "CustomActionId": -1, 
            "IsMandatory": true, 
            "DefaultValue": "", 
            "Description": "The endpoint to try to connect to", 
            "Name": "Endpoint URL", 
            "Value": "", 
            "Type": 0, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1560863453862, 
            "ModificationTimeUnixTimeInMs": 1560863453862
        },
        {
            "CustomActionId": -1,
            "IsMandatory": true,
            "DefaultValue": "",
            "Description": "The HTTP method to use when connecting to the endpoint",
            "Name": "HTTP Method",
            "Value": "GET",
            "Type": 0,
            "OptionalValues": null,
            "OptionalValuesJson": null,
            "Id": -1,
            "CreationTimeUnixTimeInMs": 1560863453864,
            "ModificationTimeUnixTimeInMs": 1560863453864
        },
        {
            "CustomActionId": -1, 
            "IsMandatory": false,
            "DefaultValue": "", 
            "Description": "The body of the HTTP request",
            "Name": "Body",
            "Value": "GET", 
            "Type": 0, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1560863453864, 
            "ModificationTimeUnixTimeInMs": 1560863453864
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": true, 
            "DefaultValue": "", 
            "Description": "The server of the proxy to connect to.", 
            "Name": "Proxy Server Address", 
            "Value": "", 
            "Type": 0, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1560863453865, 
            "ModificationTimeUnixTimeInMs": 1560863453865
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "", 
            "Description": "The username to use when connecting to the proxy.", 
            "Name": "Proxy Username", 
            "Value": "", 
            "Type": 0, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1560863453865, 
            "ModificationTimeUnixTimeInMs": 1560863453865
        }, 
        {
            "CustomActionId": -1, 
            "IsMandatory": false, 
            "DefaultValue": "", 
            "Description": "The password to use when connecting to the proxy.", 
            "Name": "Proxy Password", 
            "Value": "", 
            "Type": 12, 
            "OptionalValues": null, 
            "OptionalValuesJson": null, 
            "Id": -1, 
            "CreationTimeUnixTimeInMs": 1560863453866, 
            "ModificationTimeUnixTimeInMs": 1560863453866
        },
        {
            "CreationTimeUnixTimeInMs": 1560863453875,
            "CustomActionId": -1,
            "DefaultValue": "true",
            "Id": -1,
            "IsMandatory": true,
            "ModificationTimeUnixTimeInMs": 1560863453875,
            "Name": "Verify SSL",
            "Type": 1,
            "Value": "true",
            "Description": "Whether to verify SSL certificate or not."
        }
    ], 
    "DefaultResultValue": null, 
    "Id": -1, 
    "CreationTimeUnixTimeInMs": 1560863453842, 
    "ModificationTimeUnixTimeInMs": 1560863453842
}