{
    "CreationTimeUnixTimeInMs": 1545759862795,
    "Creator": "Admin",
    "Description": "Search across a variety of data sources for exploits and use facets to get summary information.",
    "DynamicResultsMetadata": [
        {
            "ResultExample": "{\"matches\": [{\"cve\": \"CVE-2011-2064\", \"description\": \"Cisco IOS 12.4MDA before 12.4(24)MDA5 on the Cisco Content Services Gateway - Second Generation (CSG2) allows remote attackers to cause a denial of service (device reload) via crafted ICMP packets, aka Bug ID CSCtl79577.\", \"osvdb\": [73657], \"bid\": [48581], \"source\": \"CVE\", \"_id\": \"2011-2064\", \"msb\": []}], \"facets\": {\"type\": [{\"count\": 1, \"value\": \"remote\"}]}, \"total\": 4}",
            "ResultName": "JsonResult"
        }
    ],
    "Id": -1,
    "IntegrationIdentifier": "Shodan",
    "IsCustom": false,
    "IsEnabled": true,
    "ModificationTimeUnixTimeInMs": 1545759862798,
    "Name": "SearchForExploits",
    "Parameters": [
        {
            "CreationTimeUnixTimeInMs": 1545759862806,
            "CustomActionId": 61,
            "DefaultValue": "",
            "Description": "Search query used to search the database of known exploits.",
            "Id": -1,
            "IsMandatory": true,
            "ModificationTimeUnixTimeInMs": 1545759862806,
            "Name": "Search Query",
            "Type": 0,
            "Value": ""
        },
        {
            "CreationTimeUnixTimeInMs": 1545759862806,
            "CustomActionId": 61,
            "DefaultValue": "",
            "Description": "A comma-separated list of properties to get summary information on. (i.e. port, source, author). More information can be found at https://developer.shodan.io/api",
            "Id": -1,
            "IsMandatory": false,
            "ModificationTimeUnixTimeInMs": 1545759862806,
            "Name": "Facets",
            "Type": 0,
            "Value": ""
        },
        {
            "CreationTimeUnixTimeInMs": 1545759862807,
            "CustomActionId": 61,
            "DefaultValue": "",
            "Description": "The page number to page through results 100 at a time.",
            "Id": -1,
            "IsMandatory": false,
            "ModificationTimeUnixTimeInMs": 1545759862807,
            "Name": "Page",
            "Type": 0,
            "Value": ""
        }
    ],
    "Script": "from ShodanManager import ShodanManager\nfrom SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import flat_dict_to_csv, dict_to_flat\n\n\ndef main():\n    siemplify = SiemplifyAction()\n\n    conf = siemplify.get_configuration('Shodan')\n    verify_ssl = conf.get('Verify SSL', 'False').lower() == 'true'\n    api_key = conf.get('API key', \"\")\n    shodan = ShodanManager(api_key, verify_ssl=verify_ssl)\n\n    # Parameters:\n    query = siemplify.parameters['Search Query']\n    facets = siemplify.parameters.get(\"Facets\", \"\")\n    page = int(siemplify.parameters.get(\"Page\", 1))\n\n    search_res = shodan.search_for_exploits(query, facets=facets, page=page)\n\n    if search_res:\n        # Add csv table\n        flat_report = dict_to_flat(search_res)\n        siemplify.result.add_data_table(\"Search for Exploits Results:\", flat_dict_to_csv(flat_report))\n        output_message = \"Successfully search across a variety of data sources for exploits\"\n        result_value = 'true'\n    else:\n        output_message = \"Failed to search across a variety of data sources for exploits\"\n        result_value = 'false'\n\n    siemplify.end(output_message, result_value)\n\n\nif __name__ == '__main__':\n    main()\n",
    "ScriptResultName": "is_success",
    "Version": 2.0,
    "SimulationDataJson": "{\"Entities\": []}"
}