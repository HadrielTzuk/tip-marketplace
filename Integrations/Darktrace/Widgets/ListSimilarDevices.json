{
  "type": 3,
  "actionIdentifier": "List Similar Devices",
  "title": "Darktrace - List Similar Devices",
  "description": "This widget highlights the most important items in Darktrace - List Similar Devices",
  "dataDefinition":
  {
    "htmlContent": "<!DOCTYPE html><html lang=\"en\"><head> <meta charset=\"UTF-8\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <link href=\"https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i\" rel=\"stylesheet\"> <script src=\"https://code.jquery.com/jquery-3.5.1.min.js\"></script> <title>Query Widget</title> <style>body{float: left; width: 100%; padding: 0; margin: 0; box-sizing: border-box; background-color: #212C45;}.widget-container{padding: 0 20px;}::-webkit-scrollbar{width: 0;}.logo{text-align: right; padding-top: 8px; padding-bottom: 8px;}.logo svg{vertical-align: top;}.notable table tr th{text-align: left; border-bottom: 1px solid #576B95; border-top: 1px solid #576B95; padding: 10px; font-weight: bold;}table{margin: 22px 2%; width: 96%; border-collapse: collapse; word-break: break-word;}.playbook table tr td{line-height: 16px; text-align: left; border-bottom: 1px solid #576B95; padding: 10px; color: #C3D2E8;}.MainCounter{display: flex; justify-content: center; align-items: center; padding: 32px 4% 36px 4%; text-align: center;}h1{font-weight: bold; font-size: 104px; text-shadow: 1px 1px #fff; margin: 0;}h3{font-weight: bold; font-size: 26px; margin: 0; text-align: center;}.cardContainer{display: flex;}.cntRightSide{width: 65%; padding-left: 3%; border-left: 1px solid #576B95;}.cntLeftSide{flex-direction: column; width: 30%; padding-right: 6px;}.leftMenu{height: 38px; line-height: 38px; display: block; padding-left: 10px; cursor: pointer; overflow: hidden; text-overflow: ellipsis; color: #C3D2E8}.leftMenu.active{background: #3A4A6C; font-weight: bold; color: #fff;}.fieldTitle{display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #576B95; margin-bottom: 4px; padding-top: 8px; padding-bottom: 8px;}.fieldKeyTitle{font-weight: bold; font-size: 20px; overflow: hidden; text-overflow: ellipsis; max-width: 70%;}</style></head><body style=\"font-family: Open Sans, serif; font-size: 14px; color: #fff\"><div class=\"cardContainer\" style=\"font-family: Open Sans, serif; font-size: 12px; color: #fff\"> <div class=\"cntLeftSide\" id=\"leftMenu\"></div><div class=\"cntRightSide\" id=\"rightMenu\"> <div class=\"fields\" id=\"malware\"> <div class=\"fieldTitle\"> <div class=\"fieldKeyTitle\" id=\"title\"></div><div class=\"logo\"> <svg class=\"logo-svg\" width=\"25\" height=\"25\" viewBox=\"0 0 25 25\" fill=\"currentColor\"> <path d=\"M13.29,7.78H7v-2.78h6.34c2.12,.02,3.7,.62,4.75,1.8,.85,.97,1.45,2.4,1.7,4.26-.53-.89-1.78-2.72-5.48-3.19-.34-.04-.68-.07-1.03-.09Z\"></path><path d=\"M18.85,11.69c-.15-.26-.32-.5-.51-.74l-.05-.05c-.56-.6-1.26-1.06-2.03-1.34,.06,.15,.11,.31,.15,.47,.15,.74,.24,1.5,.26,2.26,.03,.68,.02,1.36-.02,2.04-.04,.53-.12,1.06-.24,1.58-.11,.51-.33,.98-.64,1.4-.27,.37-.64,.64-1.06,.75-.47,.09-.94,.13-1.42,.12h-3.38V8.99h-2.92v10.22c0,.96,.64,1.75,1.42,1.75h5.01l.97-.02c1.42,0,2.79-.63,3.79-1.75,1.01-1.12,1.57-2.63,1.57-4.2,0-1.16-.31-2.3-.91-3.3Z\"/> </svg> </div></div></div><div class=\"MainCounter\" > <div> <h1 id=\"count\"></h1> <div class=\"simi-alerts \"> <div> <h3 id=\"alerts-title\"></h3> </div></div></div></div><div class=\"playbook notable\"> <table> <thead> <tr> <th> Hostname </th> <th> IP </th> <th> OS </th> <th> Score </th> <th> Type </th> <th> Device Label </th> </tr></thead> <tbody id=\"fieldData\"></tbody> </table> </div></div></div><script>$(document).ready(()=>{const actionListData=[{stepInstanceName}.JsonResult]; if (!actionListData.length){return;}entityDisplayed(actionListData[0]); createLeftMenu(); $(\".cntLeftSide\").click(event=>{const arrayLeftSide=$(\".leftMenu\"); const id=event.target.id; $.each(arrayLeftSide, (key, value)=>{if (value.id===id){$(`#${value.id}`).addClass(\"active\");}else{$(`#${value.id}`).removeClass(\"active\");}}); const object=actionListData.find(el=>{if (el.Entity){return removeSpecialSymbols(el.Entity)===id;}}); entityDisplayed(object);}); function entityDisplayed(el){const dataCount=el.EntityResult.length; if (dataCount===1){$(\"#alerts-title\").html(\"SIMILAR DEVICE FOUND\");}else{$(\"#alerts-title\").html(\"SIMILAR DEVICES FOUND\");}$(\"#count\").html(dataCount); $(\"#title\").html(el.Entity) $(\"#fields\").attr(\"id\", `${removeSpecialSymbols(el.Entity)}`) const iterListData=el.EntityResult; let mhtml=\"\"; $.each(iterListData, (key, el)=>{mhtml +='<tr>'; mhtml +=`<td>` + fieldExists(el.hostname) + `</td>`; mhtml +=`<td>` + fieldExists(el.ip) + `</td>`; mhtml +=`<td>` + fieldExists(el.os) + `</td>`; mhtml +=`<td>` + fieldExists(el.score) + `</td>`; mhtml +=`<td>` + fieldExists(el.typelabel) + `</td>`; mhtml +=`<td>` + fieldExists(el.devicelabel) + `</td>`; mhtml +='</tr>';}); $(\"#fieldData\").html(mhtml); $(\"th\").each(function(idx, _){const check=Boolean( $(\"tbody tr\").find(\"td:eq(\" + idx + \")\").filter(function(){return $.trim($(this).text())===\"N/A\" ? 0 : 1;}).length ); $(\"tr\").find(\"td:eq(\" + idx + \"), th:eq(\" + idx + \")\").toggle(check);}); function fieldExists(field){return field===undefined ? \"N/A\" : field;}}function createLeftMenu(){let string=\"\"; actionListData.forEach((el, index)=>{const displayValue=el.Entity; const cleanDisplayValue=removeSpecialSymbols(displayValue); index ? string +=`<div class=\"leftMenu\" id=${cleanDisplayValue}>${displayValue}</div>` : string +=`<div class=\"leftMenu active\" id=${cleanDisplayValue}>${displayValue}</div>`}) $(\"#leftMenu\").html(string)}function removeSpecialSymbols(el){return el.replaceAll(/[\\s ;:.,/%!&?-]/g, \"\").replaceAll(\"\\\", \"\",);}});</script></body></html>",
    "htmlHeight": 400,
    "safeRendering": false,
    "type": 3,
    "widgetDefinitionScope": 2
  },
  "conditionsGroup": {
    "conditions": [
      {
        "value": "true",
        "fieldName": "[{stepInstanceName}.is_success]",
        "matchType": 0
      }
    ],
    "logicalOperator": 0
  },
  "defaultSize": 1
}
