{
    "CreationTimeUnixTimeInMs": 1517341271876,
    "Creator": "admin",
    "Description": "Run arbitrary Windows Management Instrumentation Query Language (WQL) query against Microsoft SCCM Instance. Note: action is not using Siemplify entities to operate.",
    "DynamicResultsMetadata": [
        {
            "ResultExample": "[{\"AADDeviceID\": \"00000000-0000-0000-0000-000000000000\", \"AADTenantID\": \"00000000-0000-0000-0000-000000000000\", \"Active\": \"1\", \"ADSiteName\": \"Default-First-Site-Name\", \"AgentName\": [\"SMS_WINNT_SERVER_DISCOVERY_AGENT,SMS_AD_SYSTEM_DISCOVERY_AGENT,SMS_AD_SECURITY_GROUP_DISCOVERY_AGENT,MP_ClientRegistration,Heartbeat Discovery\"], \"AgentSite\": [\"SCM,SCM,SCM,SCM,SCM\"], \"AgentTime\": [\"20200903121201.000000+***,20200903000002.000000+***,20200415051330.000000+***,20200518133142.000000+***,20200831134721.000000+***\"], \"AlwaysInternet\": \"0\", \"AMTFullVersion\": null, \"AMTStatus\": \"0\", \"Build\": \"10.0.xxxxx\", \"BuildExt\": \"10.0.14393.xxx\", \"Client\": \"1\", \"ClientEdition\": \"0\", \"ClientType\": \"1\", \"ClientVersion\": \"5.00.8790.xxxx\", \"CPUType\": \"Intel64 Family 6 Model 63 Stepping 2\", \"CreationDate\": \"20200415115126.000000+***\", \"Decommissioned\": \"0\", \"DeviceOwner\": \"1\", \"DistinguishedName\": \"CN=SCCM-SCCM,OU=SCCM,OU=SCCM,DC=sccm-lab,DC=local\", \"EASDeviceID\": null, \"FullDomainName\": \"SCCM-LAB.LOCAL\", \"HardwareID\": \"2:292F7AD8AE8BDB4B3E27E8D38FFF45xxxxxxxxxx\", \"InternetEnabled\": \"0\", \"IPAddresses\": [\"1.1.1.1\"], \"IPSubnets\": [\"1.1.1.1\"], \"IPv6Addresses\": [\"fe80:0000:0000:0000:4d9a:9074:xxxx:xxxx\"], \"IPv6Prefixes\": [\"xxxx:0000:0000:0000\"], \"IsAOACCapable\": false, \"IsAssignedToUser\": true, \"IsClientAMT30Compatible\": \"0\", \"IsMachineChangesPersisted\": true, \"IsPortableOperatingSystem\": false, \"IsVirtualMachine\": false, \"IsWriteFilterCapable\": false, \"LastLogonTimestamp\": \"20200902203552.000000+***\", \"LastLogonUserDomain\": \"SCCM-LAB\", \"LastLogonUserName\": \"Administrator\", \"MACAddresses\": [\"00:50:56:A2:xx:xx\"], \"ManagementAuthority\": \"0\", \"MDMComplianceStatus\": null, \"MDMDeviceCategoryID\": null, \"Name\": \"SCCM-SCCM\", \"NetbiosName\": \"SCCM-SCCM\", \"ObjectGUID\": [\"xxx,xxx\"], \"Obsolete\": \"0\", \"OperatingSystemNameandVersion\": \"Microsoft Windows NT Server 10.0\", \"OSBranch\": \"2\", \"PreviousSMSUUID\": \"GUID:7A4A2B96-F909-xxxx-AB7C-xxxxxxxxxxx\", \"PrimaryGroupID\": \"xxx\", \"PublisherDeviceID\": null, \"ResourceDomainORWorkgroup\": \"SCCM-LAB\", \"ResourceId\": \"xxxxxxxx\", \"ResourceNames\": [\"SCCM-SCCM.sccm-lab.local\"], \"ResourceType\": \"5\", \"SecurityGroupName\": [\"SCCM-LAB\\\\Domain Computers\"], \"SerialNumber\": null, \"SID\": \"S-1-5-xx-3004247314-75612377-xxxxxxxxxx-xxxx\", \"SMBIOSGUID\": \"CF512242-xxxx-85EE-3359-xxxxxxxxxx\", \"SMSAssignedSites\": [\"SCM\"], \"SMSInstalledSites\": [\"SCM\"], \"SMSResidentSites\": [\"SCM\"], \"SMSUniqueIdentifier\": \"GUID:7A4A2B96-xxxx-446A-AB7C-xxxxxxxxxxxx\", \"SMSUUIDChangeDate\": \"20200518203142.000000+***\", \"SNMPCommunityName\": null, \"SuppressAutoProvision\": \"0\", \"SystemContainerName\": [\"\"], \"SystemGroupName\": [\"SCCM-LAB\\\\Domain Computers\"], \"SystemOUName\": [\"SCCM-LAB.LOCAL/SCCM,SCCM-LAB.LOCAL/SCCM/SCCM\"], \"SystemRoles\": [\"AI Update Service Point,Data Warehouse Service Point,SMS Component Server,SMS Distribution Point,SMS Dmp Connector,SMS Endpoint Protection Point,SMS Fallback Status Point,SMS Management Point,SMS Notification Server,SMS Site Server,SMS Site System,SMS Software Update Point,SMS SQL Server,SMS SRS Reporting Point\"], \"Unknown\": \"0\", \"UserAccountControl\": \"40xx\", \"VirtualMachineHostName\": \"\", \"VirtualMachineType\": \"0\", \"WipeStatus\": \"0\", \"WTGUniqueKey\": null}, {\"AADDeviceID\": \"00000000-0000-0000-0000-000000000000\", \"AADTenantID\": \"00000000-0000-0000-0000-000000000000\", \"Active\": \"1\", \"ADSiteName\": \"Default-First-Site-Name\", \"AgentName\": [\"SMS_AD_SYSTEM_DISCOVERY_AGENT,SMS_AD_SECURITY_GROUP_DISCOVERY_AGENT,MP_ClientRegistration,Heartbeat Discovery\"], \"AgentSite\": [\"SCM,SCM,SCM,SCM\"], \"AgentTime\": [\"20200903000002.000000+***,20200415051330.000000+***,20200518133221.000000+***,20200831133349.000000+***\"], \"AlwaysInternet\": \"0\", \"AMTFullVersion\": null, \"AMTStatus\": \"0\", \"Build\": \"1.1.1\", \"BuildExt\": \"1.1.1.1\", \"Client\": \"1\", \"ClientEdition\": \"0\", \"ClientType\": \"1\", \"ClientVersion\": \"5.00.xxxx.xxxx\", \"CPUType\": \"Intel64 Family 6 Model 63 Stepping 2\", \"CreationDate\": \"20200415121334.000000+***\", \"Decommissioned\": \"0\", \"DeviceOwner\": \"1\", \"DistinguishedName\": \"CN=SCCM-AD,OU=Domain Controllers,DC=sccm-lab,DC=local\", \"EASDeviceID\": null, \"FullDomainName\": \"SCCM-LAB.LOCAL\", \"HardwareID\": \"2:xxxxC90E1312C67C5787A8A102xxxxxxxxxxxxxx\", \"InternetEnabled\": \"0\", \"IPAddresses\": [\"1.1.1.1\"], \"IPSubnets\": [\"1.1.1.1\"], \"IPv6Addresses\": [\"\"], \"IPv6Prefixes\": [\"\"], \"IsAOACCapable\": false, \"IsAssignedToUser\": true, \"IsClientAMT30Compatible\": \"0\", \"IsMachineChangesPersisted\": true, \"IsPortableOperatingSystem\": false, \"IsVirtualMachine\": true, \"IsWriteFilterCapable\": false, \"LastLogonTimestamp\": \"20200827132153.000000+***\", \"LastLogonUserDomain\": null, \"LastLogonUserName\": null, \"MACAddresses\": [\"xx:50:56:xx:9C:xx\"], \"ManagementAuthority\": \"0\", \"MDMComplianceStatus\": null, \"MDMDeviceCategoryID\": null, \"Name\": \"SCCM-AD\", \"NetbiosName\": \"SCCM-AD\", \"ObjectGUID\": [\"xxx,xxx,xxx\"], \"Obsolete\": \"0\", \"OperatingSystemNameandVersion\": \"Microsoft Windows NT Server 10.0\", \"OSBranch\": \"2\", \"PreviousSMSUUID\": \"GUID:xxxxxxxx-B141-4B12-xxxx-95C14Dxxxxxx\", \"PrimaryGroupID\": \"xxx\", \"PublisherDeviceID\": null, \"ResourceDomainORWorkgroup\": \"SCCM-LAB\", \"ResourceId\": \"167xxxxx\", \"ResourceNames\": [\"SCCM-AD.sccm-lab.local\"], \"ResourceType\": \"5\", \"SecurityGroupName\": [\"SCCM-LAB\\\\Denied RODC Password Replication Group,SCCM-LAB\\\\Domain Controllers\"], \"SerialNumber\": null, \"SID\": \"S-1-5-21-xxxxxxxxxx-75612377-xxxxxxxxxx-xxxx\", \"SMBIOSGUID\": \"xxxxxxxx-A9DD-8BA6-xxxx-D09Axxxxxxxx\", \"SMSAssignedSites\": [\"SCM\"], \"SMSInstalledSites\": [\"SCM\"], \"SMSResidentSites\": [\"SCM\"], \"SMSUniqueIdentifier\": \"GUID:xxxxxxxx-B141-4B12-xxxx-95C14Dxxxxxx\", \"SMSUUIDChangeDate\": \"20200518203221.000000+***\", \"SNMPCommunityName\": null, \"SuppressAutoProvision\": \"0\", \"SystemContainerName\": [\"\"], \"SystemGroupName\": [\"SCCM-LAB\\\\Denied RODC Password Replication Group,SCCM-LAB\\\\Domain Controllers\"], \"SystemOUName\": [\"SCCM-LAB.LOCAL/DOMAIN CONTROLLERS\"], \"SystemRoles\": [\"\"], \"Unknown\": \"0\", \"UserAccountControl\": \"53xxxx\", \"VirtualMachineHostName\": \"\", \"VirtualMachineType\": \"0\", \"WipeStatus\": \"0\", \"WTGUniqueKey\": null}]",
            "ResultName": "JsonResult"
        }
    ],
    "Id": -1,
    "IntegrationIdentifier": "SCCM",
    "IsCustom": false,
    "IsEnabled": true,
    "ModificationTimeUnixTimeInMs": 1517341271876,
    "Name": "Run WQL Query",
    "Parameters": [
        {
            "Name": "Query to run",
            "Type": 0,
            "Value": "SELECT UniqueUserName,LastLoginTime,LoginCount,ResourceName from SMS_UserMachineIntelligence JOIN SMS_R_User ON SMS_UserMachineIntelligence.UniqueUserName = SMS_R_User.UniqueUserName WHERE SMS_R_User.UserPrincipalName = \"sccm_user@sccm-domain.com\"",
            "DefaultValue": "SELECT UniqueUserName,LastLoginTime,LoginCount,ResourceName from SMS_UserMachineIntelligence JOIN SMS_R_User ON SMS_UserMachineIntelligence.UniqueUserName = SMS_R_User.UniqueUserName WHERE SMS_R_User.UserPrincipalName = \"sccm_user@sccm-domain.com\"",
            "IsMandatory": true,
            "Description": "Specify WQL query to run. Consider the default example request for reference.",
            "CustomActionId": -1,
            "Id": -1
        },
        {
            "Name": "Number of records to return",
            "Type": 0,
            "Value": 100,
            "DefaultValue": 100,
            "IsMandatory": true,
            "Description": "Maximum number of records to return in action.",
            "CustomActionId": -1,
            "Id": -1
        }
    ],
    "ScriptResultName": "is_success",
    "Type": 0,
    "Version": 1.0
}