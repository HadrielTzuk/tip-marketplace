{
  "type": 3,
  "actionIdentifier": "Get User related activities",
  "title": "Office 365 CloudApp Security - Get User related activities",
  "description": "This widget highlights the most important items in Office 365 CloudApp Security - Get User related activities",
  "dataDefinition":
  {
    "htmlContent": "<!DOCTYPE html><html lang=\"en\"><head> <meta charset=\"UTF-8\"> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <link href=\"https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i\" rel=\"stylesheet\"> <script src=\"https://code.jquery.com/jquery-3.5.1.min.js\"></script> <title>Query Widget</title> <style>body{float: left; width: 100%; padding: 0; margin: 0; box-sizing: border-box; background-color: #212C45;}.widget-container{padding: 0 20px;}::-webkit-scrollbar{width: 0;}.logo{text-align: right; padding-top: 8px; padding-bottom: 8px;}.logo svg{vertical-align: top;}.notable table tr th{text-align: left; border-bottom: 1px solid #576B95; border-top: 1px solid #576B95; padding: 10px; font-weight: bold;}table{margin: 22px 2%; width: 96%; border-collapse: collapse; word-break: break-word;}.playbook table tr td{line-height: 16px; text-align: left; border-bottom: 1px solid #576B95; padding: 10px; color: #C3D2E8;}.MainCounter{display: flex; justify-content: center; align-items: center; padding: 32px 4% 36px 4%; text-align: center;}h1{font-weight: bold; font-size: 104px; text-shadow: 1px 1px #fff; margin: 0;}h3{font-weight: bold; font-size: 26px; margin: 0; text-align: center;}.cardContainer{display: flex;}.cntRightSide{width: 65%; padding-left: 3%; border-left: 1px solid #576B95;}.cntLeftSide{flex-direction: column; width: 30%; padding-right: 6px;}.leftMenu{height: 38px; line-height: 38px; display: block; padding-left: 10px; cursor: pointer; overflow: hidden; text-overflow: ellipsis; color: #C3D2E8}.leftMenu.active{background: #3A4A6C; font-weight: bold; color: #fff;}.fieldTitle{display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #576B95; margin-bottom: 4px; padding-top: 8px; padding-bottom: 8px;}.fieldKeyTitle{font-weight: bold; font-size: 20px; overflow: hidden; text-overflow: ellipsis; max-width: 70%;}</style></head><body style=\"font-family: Open Sans, serif; font-size: 14px; color: #fff\"><div class=\"cardContainer\" style=\"font-family: Open Sans, serif; font-size: 12px; color: #fff\"> <div class=\"cntLeftSide\" id=\"leftMenu\"></div><div class=\"cntRightSide\" id=\"rightMenu\"> <div class=\"fields\" id=\"malware\"> <div class=\"fieldTitle\"> <div class=\"fieldKeyTitle\" id=\"title\"></div><div class=\"logo\"> <svg class=\"logo-svg\" width=\"25\" height=\"25\" viewBox=\"0 0 25 25\" fill=\"currentColor\"> <path d=\"M13.05 2.75V12h9.2V2.75h-9.2zm0 19.5h9.2V13h-9.2v9.25zM2.75 12h9.2V2.75h-9.2V12zm0 10.25h9.2V13h-9.2v9.25z\" fill-rule=\"evenodd\" clip-rule=\"evenodd\"/> </svg> </div></div></div><div class=\"MainCounter\" > <div> <h1 id=\"count\"></h1> <div class=\"simi-alerts \"> <div> <h3 id=\"alerts-title\"></h3> </div></div></div></div><div class=\"playbook notable\"> <table> <thead> <tr> <th style=\"width: 20%;\"> Activity Name </th> <th style=\"width: 10%;\"> Severity </th> <th style=\"width: 15%;\"> IP </th> <th> User </th> <th> Application </th> <th style=\"width: 10%;\"> Country </th> <th> User Agent </th> </tr></thead> <tbody id=\"fieldData\"></tbody> </table> </div></div></div><script>$(document).ready(()=>{const actionListData=[{stepInstanceName}.JsonResult]; if (!actionListData.length){return;}entityDisplayed(actionListData[0]); createLeftMenu(); $(\".cntLeftSide\").click(event=>{const arrayLeftSide=$(\".leftMenu\"); const id=event.target.id; $.each(arrayLeftSide, (key, value)=>{if (value.id===id){$(`#${value.id}`).addClass(\"active\");}else{$(`#${value.id}`).removeClass(\"active\");}}); const object=actionListData.find(el=>{if (el.Entity){return removeSpecialSymbols(el.Entity)===id;}}); entityDisplayed(object);}); function entityDisplayed(el){const dataCount=el.EntityResult.length; if (dataCount===1){$(\"#alerts-title\").html(\"RELATED ACTIVITY FOUND\");}else{$(\"#alerts-title\").html(\"RELATED ACTIVITIES FOUND\");}$(\"#count\").html(dataCount); $(\"#title\").html(el.Entity) $(\"#fields\").attr(\"id\", `${removeSpecialSymbols(el.Entity)}`) const iterListData=el.EntityResult; let mhtml=\"\"; $.each(iterListData, (key, el)=>{mhtml +='<tr>'; mhtml +=`<td>` + fieldExists(el.description) + `</td>`; mhtml +=`<td>` + fieldExists(el.severity) + `</td>`; mhtml +=`<td>` + fieldExists(el.device.clientIP) + `</td>`; mhtml +=`<td>` + fieldExists(el.user.userName) + `</td>`; mhtml +=`<td>` + fieldExists(el.appName) + `</td>`; mhtml +=`<td>` + fieldExists(el.device.countryCode) + `</td>`; mhtml +=`<td>` + fieldExists(el.device.userAgent) + `</td>`; mhtml +='</tr>';}); $(\"#fieldData\").html(mhtml); $(\"th\").each(function(idx, _){const check=Boolean( $(\"tbody tr\").find(\"td:eq(\" + idx + \")\").filter(function(){return $.trim($(this).text())===\"N/A\" ? 0 : 1;}).length ); $(\"tr\").find(\"td:eq(\" + idx + \"), th:eq(\" + idx + \")\").toggle(check);}); function fieldExists(field){return field===undefined ? \"N/A\" : field;}}function createLeftMenu(){let string=\"\"; actionListData.forEach((el, index)=>{const displayValue=el.Entity; const cleanDisplayValue=removeSpecialSymbols(displayValue); index ? string +=`<div class=\"leftMenu\" id=${cleanDisplayValue}>${displayValue}</div>` : string +=`<div class=\"leftMenu active\" id=${cleanDisplayValue}>${displayValue}</div>`}) $(\"#leftMenu\").html(string)}function removeSpecialSymbols(el){return el.replaceAll(/[\\s ;:.,/%!&?-]/g, \"\").replaceAll(\"\\\", \"\",);}});</script></body></html>",
    "htmlHeight": 400,
    "safeRendering": false,
    "type": 3,
    "widgetDefinitionScope": 2
  },
  "conditionsGroup": {
    "conditions": [
      {
        "value": "true",
        "fieldName": "[{stepInstanceName}.is_success]",
        "matchType": 0
      },
      {
        "value": "[]",
        "fieldName": "[{stepInstanceName}.JsonResult]",
        "matchType": 5
      }
    ],
    "logicalOperator": 0
  },
  "defaultSize": 1
}
