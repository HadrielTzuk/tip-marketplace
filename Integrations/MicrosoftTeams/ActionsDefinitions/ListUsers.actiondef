{
    "CreationTimeUnixTimeInMs": 1543164953601,
    "Creator": "admin",
    "Description": "Get all users details",
    "DynamicResultsMetadata": [
        {
            "ResultExample": "[{\"isResourceAccount\": null, \"mailNickname\": \"admin\", \"surname\": \"test\", \"deletedDateTime\": null, \"assignedLicenses\": [{\"skuId\": \"16ddbbfc-09ea-4de2-b1d7-312db6112d70\", \"disabledPlans\": []}], \"userPrincipalName\": \"john_doe@example.com\", \"faxNumber\": null, \"consentProvidedForMinor\": null, \"userType\": \"Member\", \"officeLocation\": null, \"usageLocation\": \"IL\", \"city\": null, \"employeeId\": null, \"onPremisesImmutableId\": null, \"preferredLanguage\": \"en\", \"streetAddress\": null, \"id\": \"0cf5ab11-13fc-474c-abaf-cf2b69ee77a9\", \"state\": null, \"businessPhones\": [\"0542533879\"], \"postalCode\": null, \"mail\": \"john_doe@example.com\", \"onPremisesSamAccountName\": null, \"onPremisesLastSyncDateTime\": null, \"accountEnabled\": true, \"mobilePhone\": null, \"refreshTokensValidFromDateTime\": \"2018-11-12T13:26:42Z\", \"companyName\": null, \"deviceKeys\": [], \"jobTitle\": null, \"preferredDataLocation\": null, \"showInAddressList\": null, \"department\": null, \"proxyAddresses\": [\"SMTP:connectortest0@gmail.com\"], \"externalUserStateChangeDateTime\": null, \"onPremisesProvisioningErrors\": [], \"legalAgeGroupClassification\": null, \"onPremisesSyncEnabled\": null, \"onPremisesExtensionAttributes\": {\"extensionAttribute4\": null, \"extensionAttribute5\": null, \"extensionAttribute6\": null, \"extensionAttribute7\": null, \"extensionAttribute12\": null, \"extensionAttribute1\": null, \"extensionAttribute2\": null, \"extensionAttribute3\": null, \"extensionAttribute10\": null, \"extensionAttribute11\": null, \"extensionAttribute8\": null, \"extensionAttribute9\": null, \"extensionAttribute14\": null, \"extensionAttribute15\": null, \"extensionAttribute13\": null}, \"assignedPlans\": [{\"capabilityStatus\": \"Enabled\", \"servicePlanId\": \"617d9209-3b90-4879-96e6-838c42b2701d\", \"service\": \"MicrosoftCommunicationsOnline\", \"assignedDateTime\": \"2018-11-12T13:27:18Z\"}, {\"capabilityStatus\": \"Enabled\", \"servicePlanId\": \"902b47e5-dcb2-4fdc-858b-c63a90a2bdb9\", \"service\": \"SharePoint\", \"assignedDateTime\": \"2018-11-12T13:27:18Z\"}, {\"capabilityStatus\": \"Enabled\", \"servicePlanId\": \"4fa4026d-ce74-4962-a151-8e96d57ea8e4\", \"service\": \"TeamspaceAPI\", \"assignedDateTime\": \"2018-11-12T13:27:18Z\"}], \"passwordProfile\": null, \"passwordPolicies\": null, \"externalUserState\": null, \"otherMails\": [\"connectortest0@gmail.com\"], \"displayName\": \"connector test\", \"imAddresses\": [], \"provisionedPlans\": [{\"capabilityStatus\": \"Enabled\", \"provisioningStatus\": \"Success\", \"service\": \"SharePoint\"}], \"createdDateTime\": \"2018-11-12T13:26:42Z\", \"country\": null, \"onPremisesDistinguishedName\": null, \"onPremisesSecurityIdentifier\": null, \"onPremisesDomainName\": null, \"onPremisesUserPrincipalName\": null, \"givenName\": \"connector\", \"ageGroup\": null}, {\"isResourceAccount\": null, \"mailNickname\": \"usename.co#EXT#\", \"surname\": null, \"deletedDateTime\": null, \"assignedLicenses\": [{\"skuId\": \"16ddbbfc-09ea-4de2-b1d7-312db6112d70\", \"disabledPlans\": []}], \"userPrincipalName\": \"username@domain.com#EXT#@tenant.onmicrosoft.com\", \"faxNumber\": null, \"consentProvidedForMinor\": null, \"userType\": \"Member\", \"officeLocation\": null, \"usageLocation\": \"IL\", \"city\": null, \"employeeId\": null, \"onPremisesImmutableId\": null, \"preferredLanguage\": null, \"streetAddress\": null, \"id\": \"5e457a85-a705-4b65-8a9f-3a3d2ad7715c\", \"state\": null, \"businessPhones\": [], \"postalCode\": null, \"mail\": \"john_doe@example.com\", \"onPremisesSamAccountName\": null, \"onPremisesLastSyncDateTime\": null, \"accountEnabled\": true, \"mobilePhone\": null, \"refreshTokensValidFromDateTime\": \"2018-11-12T13:28:53Z\", \"companyName\": null, \"deviceKeys\": [], \"jobTitle\": null, \"preferredDataLocation\": null, \"showInAddressList\": false, \"department\": null, \"proxyAddresses\": [\"SMTP:username@domain.com\"], \"externalUserStateChangeDateTime\": \"2018-11-12T13:29:41Z\", \"onPremisesProvisioningErrors\": [], \"legalAgeGroupClassification\": null, \"onPremisesSyncEnabled\": null, \"onPremisesExtensionAttributes\": {\"extensionAttribute4\": null, \"extensionAttribute5\": null, \"extensionAttribute6\": null, \"extensionAttribute7\": null, \"extensionAttribute12\": null, \"extensionAttribute1\": null, \"extensionAttribute2\": null, \"extensionAttribute3\": null, \"extensionAttribute10\": null, \"extensionAttribute11\": null, \"extensionAttribute8\": null, \"extensionAttribute9\": null, \"extensionAttribute14\": null, \"extensionAttribute15\": null, \"extensionAttribute13\": null}, \"assignedPlans\": [{\"capabilityStatus\": \"Enabled\", \"servicePlanId\": \"617d9209-3b90-4879-96e6-838c42b2701d\", \"service\": \"MicrosoftCommunicationsOnline\", \"assignedDateTime\": \"2018-11-12T13:28:57Z\"}, {\"capabilityStatus\": \"Enabled\", \"servicePlanId\": \"902b47e5-dcb2-4fdc-858b-c63a90a2bdb9\", \"service\": \"SharePoint\", \"assignedDateTime\": \"2018-11-12T13:28:57Z\"}, {\"capabilityStatus\": \"Enabled\", \"servicePlanId\": \"4fa4026d-ce74-4962-a151-8e96d57ea8e4\", \"service\": \"TeamspaceAPI\", \"assignedDateTime\": \"2018-11-12T13:28:57Z\"}], \"passwordProfile\": null, \"passwordPolicies\": null, \"externalUserState\": \"Accepted\", \"otherMails\": [\"username@domaim.com\"], \"displayName\": \"username\", \"imAddresses\": [], \"provisionedPlans\": [{\"capabilityStatus\": \"Enabled\", \"provisioningStatus\": \"Success\", \"service\": \"SharePoint\"}], \"createdDateTime\": \"2018-11-12T13:28:53Z\", \"country\": null, \"onPremisesDistinguishedName\": null, \"onPremisesSecurityIdentifier\": null, \"onPremisesDomainName\": null, \"onPremisesUserPrincipalName\": null, \"givenName\": null, \"ageGroup\": null}]",
            "ResultName": "JsonResult"
        }
    ],
    "Id": -1,
    "IntegrationIdentifier": "MicrosoftTeams",
    "IsCustom": false,
    "IsEnabled": true,
    "ModificationTimeUnixTimeInMs": 1543164953601,
    "Name": "List Users",
    "Parameters": [
        {
            "CreationTimeUnixTimeInMs": 1543229155775,
            "CustomActionId": -1,
            "DefaultValue": "50",
            "Description": "Specify how many users to return. Default: 50.",
            "Id": -1,
            "IsMandatory": false,
            "ModificationTimeUnixTimeInMs": 1543229155775,
            "Name": "Max Users To Return",
            "Type": 0,
            "Value": "50"
        }
    ],
    "Script": "from SiemplifyAction import SiemplifyAction\r\nfrom MicrosoftManager import MicrosoftTeamsManager\r\nimport json\r\n\r\n\r\ndef main():\r\n    siemplify = SiemplifyAction()\r\n\r\n    conf = siemplify.get_configuration(\"MicrosoftTeams\")\r\n    client_id = conf[\"Client ID\"]\r\n    secret_id = conf[\"Secret ID\"]\r\n    tenant = conf[\"Tenant\"]\r\n    token = conf.get(\"Refresh Token\")\r\n\r\n    mtm = MicrosoftTeamsManager(client_id, secret_id, tenant)\r\n\r\n    # refresh token\r\n    mtm.refresh_token(token)\r\n\r\n    teams = mtm.list_teams() or []\r\n\r\n    for team in teams:\r\n        siemplify.result.add_json(\"Team {0}\".format(team.get(\"displayName\")), json.dumps(teams))\r\n    if teams:\r\n        output_message = \"Successfully get teams.\"\r\n    else:\r\n        output_message = \"No results were found.\"\r\n\r\n    siemplify.end(output_message, json.dumps(teams))\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n\r\n",
    "ScriptResultName": "users",
    "Version": 1.0,
    "SimulationDataJson": "{\"Entities\": []}"
}