{
  "type": 3,
  "actionIdentifier": "Lookup Similar Alerts",
  "title": "Google Chronicle - Lookup Similar Alerts",
  "description": "This widget returns information about the lookup similar alerts that were enriched by Google Chronicle.",
  "dataDefinition":
  {
    "htmlContent": "<!DOCTYPE html><html><head> <title></title> <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"> <meta charset=\"UTF-8\"> <link href=\"https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700,700i\" rel=\"stylesheet\"><script src=\"https://code.jquery.com/jquery-3.5.1.min.js\"></script> <style> body { margin:0; padding: 0; background-color: #212C45; } .logo { display: flex; justify-content: flex-end; padding-top: 16px; padding-right: 8px; } .AlertsFound { display: flex; justify-content: center; align-items: center; padding: 0 4% 32px 4%; text-align: center; } .playbook p { font-size: 14px; line-height: 19px; margin: 20px 0; } h1 { font-weight: bold; font-size: 104px; text-shadow: 1px 1px #fff; margin: 0; } h3 { font-weight: bold; font-size: 26px; margin: 0; text-align: center; } . .simi-alerts a { font-size: 14px; color: #669DF6; text-decoration-line: underline; } .simi-alerts p { margin: 4px 0 0; } ::-webkit-scrollbar { width: 0; } .notable table tr th { text-align: left; border-bottom: 1px solid #576B95; border-top: 1px solid #576B95; padding: 10px; font-weight: bold; } table { margin: 22px 2%; width: 96%; border-collapse: collapse; word-break: break-word; } .playbook table tr td { line-height: 16px; text-align: left; border-bottom: 1px solid #576B95; padding: 10px; color: #C3D2E8; } .notable table tr td:first-child a { color: #669DF6; text-decoration-line: underline; } </style></head><body style=\"margin:0 auto;font-family: Open Sans, serif; font-size: 12px; color: #fff\"> <div class=\"logo\"> <svg width=\"53\" viewBox=\"0 0 25 25\" fill=\"currentColor\"> <path d=\"M12.4,23l8.3-5.2v-4.6L8.4,20.6L12.4,23z M8.4,20.6V8.9L4,6.3v11.5L8.4,20.6z M4,2v4.3h17V2H4z\"></path> </svg> </div> <div class=\"AlertsFound\" > <div> <h1 id=\"count\">[{stepInstanceName}.JsonResult| \"count\"]</h1> <div class=\"simi-alerts \"> <div> <h3>SIMILAR ALERTS FOUND</h3> </div> <a href='[{stepInstanceName}.JsonResult| \"external_url\"]' id=\"browse_in_chronicle_external\" target=\"_blank\">Browse In Chronicle</a> <p class=\"txtDetails\"><span id=\"alerts\">[{stepInstanceName}.JsonResult| \"processed_alerts\"] </span> alerts reviewed - run time <span id=\"run_time\">[{stepInstanceName}.JsonResult| \"run_time\"]</span> sec</p> </div> </div> </div><div class=\"playbook notable\"> <table> <thead> <tr> <th>Pivot Entity</th> <th>Alert Name</th> <th>Product</th> <th>Target</th> <th>First Seen</th> <th>Last Seen</th> </tr> </thead> <tbody id=\"fieldData\"> </tbody> </table></div><script> $(document).ready(function(){ var urlExternal = $(\"#browse_in_chronicle_external\").attr('href'); if (urlExternal.includes('[') || !urlExternal) $(\"#browse_in_chronicle_external\").hide(); $(\"#count:contains('[')\").html('0'); $(\"#alerts:contains('[')\").html('0'); $(\"#run_time:contains('[')\").html(''); function nFormatter(num, digits) { var si = [ { value: 1, symbol: \"\" }, { value: 1E3, symbol: \"k\" }, { value: 1E6, symbol: \"M\" }, { value: 1E9, symbol: \"G\" }, { value: 1E12, symbol: \"T\" }, { value: 1E15, symbol: \"P\" }, { value: 1E18, symbol: \"E\" } ]; var rx = /\\.0+$|(\\.[0-9]*[1-9])0+$/; var i; for (i = si.length - 1; i > 0; i--) { if (num >= si[i].value) { break; } } return (num / si[i].value).toFixed(digits).replace(rx, \"$1\") + si[i].symbol; } var cusAlert = $(\"#alerts\").html(); cusAlert = nFormatter(parseInt(cusAlert),1); $(\"#alerts\").html(cusAlert); var run_time_floatVal = parseFloat($(\"#run_time\").html()).toFixed(2); $(\"#run_time\").html(run_time_floatVal); if(parseInt($(\"#count\").html())==0){ $(\"#browse_in_chronicle_cbn\").hide(); $(\"#browse_in_chronicle_rule\").hide(); $(\".txtDetails\").hide(); } var jsonData = [GoogleChronicle_Lookup Similar Alerts_1.JsonResult]; var mhtml = ''; var lp=0; if (typeof jsonData.distinct !== 'undefined' && jsonData.distinct.length > 0) { }else{ $(\"#fieldData\").html('Nothing found'); return false; } $.each(jsonData.distinct, function(key, val){ mhtml+='<tr>'; mhtml+='<td><a href='+jsonData.cbn_url+'>'+val.used_ioc_asset+'</a></td>'; mhtml+='<td>'+val.name+'</td>'; mhtml+='<td>'+val.product_name+'</td>'; mhtml+='<td>'; if (val.hostnames.trim() != \"\"){ mhtml+='hostnames: '+val.hostnames+'<br/>'; } if (val.urls.trim() != \"\"){ mhtml+='urls: '+val.urls+'<br/>'; } if (val.ips.trim() != \"\"){ mhtml+='ips: '+val.ips+'<br/>'; } if (val.subjects.trim() != \"\"){ mhtml+='subjects: '+val.subjects+'<br/>'; } if (val.users.trim() != \"\"){ mhtml+='users: '+val.users+'<br/>'; } if (val.email_addresses.trim() != \"\"){ mhtml+='email_addresses: '+val.email_addresses+'<br/>'; } if (val.hashes.trim() != \"\"){ mhtml+='hashes: '+val.hashes+'<br/>'; } if (val.processes.trim() != \"\"){ mhtml+='processes: '+val.processes+'<br/>'; } mhtml+='</td>'; mhtml+='<td>'+val.first_seen+'</td>'; mhtml+='<td>'+val.last_seen+'</td>'; mhtml+='</tr>'; }); $(\"#fieldData\").html(mhtml); });</script></body></html>",
    "htmlHeight": 400,
    "safeRendering": false,
    "type": 3,
    "widgetDefinitionScope": 2
  },
  "conditionsGroup": {
    "conditions": [
      {
        "value": "firstActiveTime",
        "fieldName": "[{stepInstanceName}.JsonResult| \"EntityResult\"]",
        "matchType": 1
      }
    ],
    "logicalOperator": 0
  },
  "defaultSize": 1
}